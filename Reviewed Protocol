"""Protocol for the processing of raw CHIP-seq data"""

"""Choose the raw CHIP-seq files you want to process/visualize"""
"""Download the raw files, from the NCBI GEO page. The raw data is located in the .sra files"""
"""Check and write down the specific name of the file/sample for example: GSM1341951, this name 
you use in all the files that contain the same or processed information from the rawfile source."""

"""Convert the .sra file to a gzipped FASTQ using fastq-dump, this new file format can be read 
by the functions you are going to use next"""

fastq-dump --gzip <rawfile_name> 
#for example SRR1185473.sra

"""Remove the .sra file and rename the FastQ file the sample ID (GSM ID)"""

rm <rawfile_name> 
#for example SRR1185473.sra

mv <FastQfile_name> <SampleID+file_name>
#for example: mv SRR1185473.fastq.gz GSM1341951.fastq.gz

"""Remove adapters with Trimmomatic, set TRIM_PATH to location where Trimmomatic is lacated on your computer"""

mkdir fastqc.out 
#make the directory the fastqc reports will be saved.

fastqc *.fastq.gz -o fastqc.out
#excute the fastqc function on your .fastq.gz file and place the results in the directory fastqc.out.

trimmomatic-0.32.jar SE <SampleID+file_name>.fastq.gz  <SampleID+file_name>.trimmed.fastq.gz
#example:<GSM1341951>

"""Do all previous steps for all files that you wish to analyse before continuing."""


"""Read Mapping, get the reference genome of the species you are analysing sequences from """

mkdir <short_genome_name>
#example:mm10

cd <short_genome_name>

wget <URL_of_chosen_genome>
#example: <http://hgdownload.cse.ucsc.edu/golden-Path/mm10/bigZips/chromFa.tar.gz>

tar cvzf <name_of_fasta_file_of_chosen_genome.tar.gz> 
#example: <chromFa.tar.gz>

cat *.fa <short_genome_name>.fa

"""Optionally delete seperate chromosome .fa files."""

rm -f chr*.fa

"""Index the chosen genome using bwa"""

bwa index <short_genome_name>.fa 
#example: <mm10>.fa

"""Map reads of GSM1341951.trimmed.fastq.gz

bwa aln -t 12 <short_genome_name.fa> | bwa samse mm10/mm10.fa - GSM1341951.trimmed.
fastq.gz | samtools view -Sb - > GSM1341951.mm10.bam
#examle:bwa aln -t 12 mm10/mm10.fa | bwa samse mm10/mm10.fa - GSM1341951.trimmed.
fastq.gz | samtools view -Sb - > GSM1341951.mm10.bam



